<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>scirpy.ir_dist.metrics.AlignmentDistanceCalculator &mdash; scirpy  documentation</title>

      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/scanpy.css" type="text/css" />
      <link rel="stylesheet" href="../_static/typehints.css" type="text/css" />

  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>


    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="scirpy.ir_dist.metrics.AlignmentDistanceCalculator.DTYPE" href="scirpy.ir_dist.metrics.AlignmentDistanceCalculator.DTYPE.html" />
    <link rel="prev" title="scirpy.ir_dist.metrics.HammingDistanceCalculator.squarify" href="scirpy.ir_dist.metrics.HammingDistanceCalculator.squarify.html" />
 


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/scirpy_logo_bright.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.10.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage-principles.html">Usage principles</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.io">Input/Output: <code class="docutils literal notranslate"><span class="pre">io</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.pp">Preprocessing: <code class="docutils literal notranslate"><span class="pre">pp</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.tl">Tools: <code class="docutils literal notranslate"><span class="pre">tl</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.pl">Plotting: <code class="docutils literal notranslate"><span class="pre">pl</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.datasets">Datasets: <code class="docutils literal notranslate"><span class="pre">datasets</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.util">Utility functions: <code class="docutils literal notranslate"><span class="pre">util</span></code></a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#module-scirpy.ir_dist">IR distance utilities: <code class="docutils literal notranslate"><span class="pre">ir_dist</span></code></a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="scirpy.ir_dist.sequence_dist.html">scirpy.ir_dist.sequence_dist</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../api.html#distance-metrics">distance metrics</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="scirpy.ir_dist.metrics.DistanceCalculator.html">scirpy.ir_dist.metrics.DistanceCalculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="scirpy.ir_dist.metrics.ParallelDistanceCalculator.html">scirpy.ir_dist.metrics.ParallelDistanceCalculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="scirpy.ir_dist.metrics.IdentityDistanceCalculator.html">scirpy.ir_dist.metrics.IdentityDistanceCalculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="scirpy.ir_dist.metrics.LevenshteinDistanceCalculator.html">scirpy.ir_dist.metrics.LevenshteinDistanceCalculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="scirpy.ir_dist.metrics.HammingDistanceCalculator.html">scirpy.ir_dist.metrics.HammingDistanceCalculator</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">scirpy.ir_dist.metrics.AlignmentDistanceCalculator</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ir-biology.html">Immune receptor (IR) model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_docs.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">Other versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zzz_bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">scirpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../api.html">API</a> &raquo;</li>
      <li>scirpy.ir_dist.metrics.AlignmentDistanceCalculator</li>
      <li class="wy-breadcrumbs-aside">
              <!-- User defined GitHub URL -->
              <a href="https://github.com/icbi-lab/scirpy/tree/master/scirpy/ir_dist/metrics.py#L399-L504" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="scirpy-ir-dist-metrics-alignmentdistancecalculator">
<h1>scirpy.ir_dist.metrics.AlignmentDistanceCalculator<a class="headerlink" href="#scirpy-ir-dist-metrics-alignmentdistancecalculator" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="scirpy.ir_dist.metrics.AlignmentDistanceCalculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scirpy.ir_dist.metrics.</span></span><span class="sig-name descname"><span class="pre">AlignmentDistanceCalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subst_mat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blosum62'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_open</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_extend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scirpy.ir_dist.metrics.AlignmentDistanceCalculator" title="Permalink to this definition"></a></dt>
<dd><p>Calculates distance between sequences based on pairwise sequence alignment.</p>
<p>The distance between two sequences is defined as <span class="math notranslate nohighlight">\(S_{1,2}^{max} - S_{1,2}\)</span>,
where <span class="math notranslate nohighlight">\(S_{1,2}\)</span> is the alignment score of sequences 1 and 2 and
<span class="math notranslate nohighlight">\(S_{1,2}^{max}\)</span> is the max. achievable alignment score of sequences 1 and 2.
<span class="math notranslate nohighlight">\(S_{1,2}^{max}\)</span> is defined as <span class="math notranslate nohighlight">\(\min(S_{1,1}, S_{2,2})\)</span>.</p>
<p>The use of alignment-based distances is heavily inspired by <span id="id1">[<a class="reference internal" href="../zzz_bibliography.html#id6" title="Pradyot Dash, Andrew J. Fiore-Gartland, Tomer Hertz, George C. Wang, Shalini Sharma, Aisha Souquette, Jeremy Chase Crawford, E. Bridie Clemens, Thi H. O. Nguyen, Katherine Kedzierska, Nicole L. La Gruta, Philip Bradley, and Paul G. Thomas. Quantifiable predictive features define epitope-specific t cell receptor repertoires. Nature, 547(7661):89–93, June 2017. URL: https://doi.org/10.1038/nature22383, doi:10.1038/nature22383.">DFGH+17</a>]</span>.</p>
<p>High-performance sequence alignments are calculated leveraging
the <a class="reference external" href="https://github.com/jeffdaily/parasail-python">parasail library</a> (<span id="id2">[<a class="reference internal" href="../zzz_bibliography.html#id17" title="Jeff Daily. Parasail: SIMD c library for global, semi-global, and local pairwise sequence alignments. BMC Bioinformatics, February 2016. URL: https://doi.org/10.1186/s12859-016-0930-z, doi:10.1186/s12859-016-0930-z.">Dai16</a>]</span>).</p>
<dl>
<dt>Choosing a cutoff:</dt><dd><p>Alignment distances need to be viewed in the light of the substitution matrix.
The alignment distance is the difference between the actual alignment
score and the max. achievable alignment score. For instance, a mutation
from <em>Leucine</em> (<code class="docutils literal notranslate"><span class="pre">L</span></code>) to <em>Isoleucine</em> (<code class="docutils literal notranslate"><span class="pre">I</span></code>) results in a BLOSUM62 score of <code class="docutils literal notranslate"><span class="pre">2</span></code>.
An <code class="docutils literal notranslate"><span class="pre">L</span></code> aligned with <code class="docutils literal notranslate"><span class="pre">L</span></code> achieves a score of <code class="docutils literal notranslate"><span class="pre">4</span></code>. The distance is, therefore, <code class="docutils literal notranslate"><span class="pre">2</span></code>.</p>
<p>On the other hand, a single <em>Tryptophane</em> (<code class="docutils literal notranslate"><span class="pre">W</span></code>) mutating into, e.g.
<em>Proline</em> (<code class="docutils literal notranslate"><span class="pre">P</span></code>) already results in a distance of <code class="docutils literal notranslate"><span class="pre">15</span></code>.</p>
<p>We are still lacking empirical data up to which distance a CDR3 sequence still
is likely to recognize the same antigen, but reasonable cutoffs are <code class="docutils literal notranslate"><span class="pre">&lt;15</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cutoff</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</dt><dd><p>Will eleminate distances &gt; cutoff to make efficient
use of sparse matrices. The default cutoff is <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p>
</dd>
<dt><strong>n_jobs</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</dt><dd><p>Number of jobs to use for the pairwise distance calculation.
If None, use all jobs (only for ParallelDistanceCalculators).</p>
</dd>
<dt><strong>block_size</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">50</span></code>)</dt><dd><p>The width of a block of the matrix that will be delegated to a worker
process. The block contains <code class="docutils literal notranslate"><span class="pre">block_size</span> <span class="pre">**</span> <span class="pre">2</span></code> elements.</p>
</dd>
<dt><strong>subst_mat</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">'blosum62'</span></code>)</dt><dd><p>Name of parasail substitution matrix</p>
</dd>
<dt><strong>gap_open</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">11</span></code>)</dt><dd><p>Gap open penalty</p>
</dd>
<dt><strong>gap_extend</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">11</span></code>)</dt><dd><p>Gap extend penatly</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Attributes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="scirpy.ir_dist.metrics.AlignmentDistanceCalculator.DTYPE.html#scirpy.ir_dist.metrics.AlignmentDistanceCalculator.DTYPE" title="scirpy.ir_dist.metrics.AlignmentDistanceCalculator.DTYPE"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DTYPE</span></code></a></p></td>
<td><p>The sparse matrix dtype.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="scirpy.ir_dist.metrics.AlignmentDistanceCalculator.calc_dist_mat.html#scirpy.ir_dist.metrics.AlignmentDistanceCalculator.calc_dist_mat" title="scirpy.ir_dist.metrics.AlignmentDistanceCalculator.calc_dist_mat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_dist_mat</span></code></a>(seqs[, seqs2])</p></td>
<td><p>Calculate the distance matrix.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="scirpy.ir_dist.metrics.AlignmentDistanceCalculator.squarify.html#scirpy.ir_dist.metrics.AlignmentDistanceCalculator.squarify" title="scirpy.ir_dist.metrics.AlignmentDistanceCalculator.squarify"><code class="xref py py-obj docutils literal notranslate"><span class="pre">squarify</span></code></a>(triangular_matrix)</p></td>
<td><p>Mirror a triangular matrix at the diagonal to make it a square matrix.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="scirpy.ir_dist.metrics.HammingDistanceCalculator.squarify.html" class="btn btn-neutral float-left" title="scirpy.ir_dist.metrics.HammingDistanceCalculator.squarify" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="scirpy.ir_dist.metrics.AlignmentDistanceCalculator.DTYPE.html" class="btn btn-neutral float-right" title="scirpy.ir_dist.metrics.AlignmentDistanceCalculator.DTYPE" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Gregor Sturm, Tamas Szabo..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>