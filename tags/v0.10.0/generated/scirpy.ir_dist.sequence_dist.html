<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>scirpy.ir_dist.sequence_dist &mdash; scirpy  documentation</title>

      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/scanpy.css" type="text/css" />
      <link rel="stylesheet" href="../_static/typehints.css" type="text/css" />

  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>


    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="scirpy.ir_dist.metrics.DistanceCalculator" href="scirpy.ir_dist.metrics.DistanceCalculator.html" />
    <link rel="prev" title="scirpy.util.graph.igraph_from_sparse_matrix" href="scirpy.util.graph.igraph_from_sparse_matrix.html" />
 


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/scirpy_logo_bright.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.10.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage-principles.html">Usage principles</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.io">Input/Output: <code class="docutils literal notranslate"><span class="pre">io</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.pp">Preprocessing: <code class="docutils literal notranslate"><span class="pre">pp</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.tl">Tools: <code class="docutils literal notranslate"><span class="pre">tl</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.pl">Plotting: <code class="docutils literal notranslate"><span class="pre">pl</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.datasets">Datasets: <code class="docutils literal notranslate"><span class="pre">datasets</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.util">Utility functions: <code class="docutils literal notranslate"><span class="pre">util</span></code></a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#module-scirpy.ir_dist">IR distance utilities: <code class="docutils literal notranslate"><span class="pre">ir_dist</span></code></a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">scirpy.ir_dist.sequence_dist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api.html#distance-metrics">distance metrics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ir-biology.html">Immune receptor (IR) model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_docs.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">Other versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zzz_bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">scirpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../api.html">API</a> &raquo;</li>
      <li>scirpy.ir_dist.sequence_dist</li>
      <li class="wy-breadcrumbs-aside">
              <!-- User defined GitHub URL -->
              <a href="https://github.com/icbi-lab/scirpy/tree/master/scirpy/ir_dist/__init__.py#L231-L297" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="scirpy-ir-dist-sequence-dist">
<h1>scirpy.ir_dist.sequence_dist<a class="headerlink" href="#scirpy-ir-dist-sequence-dist" title="Permalink to this headline"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="scirpy.ir_dist.sequence_dist">
<span class="sig-prename descclassname"><span class="pre">scirpy.ir_dist.</span></span><span class="sig-name descname"><span class="pre">sequence_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seqs2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'identity'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scirpy.ir_dist.sequence_dist" title="Permalink to this definition"></a></dt>
<dd><p>Calculate a sequence x sequence distance matrix.</p>
<p>Calculates the full pairwise distance matrix.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<ul class="simple">
<li><p>Distances are offset by 1 to allow efficient use of sparse matrices
(<span class="math notranslate nohighlight">\(d' = d+1\)</span>).</p></li>
<li><p>That means, a <code class="docutils literal notranslate"><span class="pre">distance</span> <span class="pre">&gt;</span> <span class="pre">cutoff</span></code> is represented as <code class="docutils literal notranslate"><span class="pre">0</span></code>, a <code class="docutils literal notranslate"><span class="pre">distance</span> <span class="pre">==</span> <span class="pre">0</span></code>
is represented as <code class="docutils literal notranslate"><span class="pre">1</span></code>, a <code class="docutils literal notranslate"><span class="pre">distance</span> <span class="pre">==</span> <span class="pre">1</span></code> is represented as <code class="docutils literal notranslate"><span class="pre">2</span></code> and so on.</p></li>
<li><p>Only returns distances <code class="docutils literal notranslate"><span class="pre">&lt;=</span> <span class="pre">cutoff</span></code>. Larger distances are eliminated
from the sparse matrix.</p></li>
<li><p>Distances are non-negative.</p></li>
</ul>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">seqs</span></code> or <code class="docutils literal notranslate"><span class="pre">seqs2</span></code> includes non-unique values, the function internally
uses only unique sequences to calculate the distances. Note that, if the
input arrays contain large numbers of duplicated values (i.e. hundreds each),
this will lead to large “dense” blocks in the sparse matrix. This will result in
slow processing and high memory usage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>seqs</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span></dt><dd><p>Numpy array of nucleotide or amino acid sequences.
Note that not all distance metrics support nucleotide sequences.</p>
</dd>
<dt><strong>seqs2</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>] | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]</span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</dt><dd><p>Second array sequences. When omitted, <code class="docutils literal notranslate"><span class="pre">sequence_dist</span></code> computes
the square matrix of <code class="docutils literal notranslate"><span class="pre">unique_seqs</span></code>.</p>
</dd>
<dt><strong>metric</strong> : <span class="annotation terse">{‘alignment’, ‘identity’, ‘levenshtein’, ‘hamming’} | <a class="reference internal" href="scirpy.ir_dist.metrics.DistanceCalculator.html#scirpy.ir_dist.metrics.DistanceCalculator" title="scirpy.ir_dist.metrics.DistanceCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistanceCalculator</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[‘alignment’, ‘identity’, ‘levenshtein’, ‘hamming’], <a class="reference internal" href="scirpy.ir_dist.metrics.DistanceCalculator.html#scirpy.ir_dist.metrics.DistanceCalculator" title="scirpy.ir_dist.metrics.DistanceCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistanceCalculator</span></code></a>]</span> (default: <code class="docutils literal notranslate"><span class="pre">'identity'</span></code>)</dt><dd><p><dl class="simple">
<dt>You can choose one of the following metrics:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">identity</span></code> – 1 for identical sequences, 0 otherwise.
See <a class="reference internal" href="scirpy.ir_dist.metrics.IdentityDistanceCalculator.html#scirpy.ir_dist.metrics.IdentityDistanceCalculator" title="scirpy.ir_dist.metrics.IdentityDistanceCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">IdentityDistanceCalculator</span></code></a>.
This metric implies a cutoff of 0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">levenshtein</span></code> – Levenshtein edit distance.
See <a class="reference internal" href="scirpy.ir_dist.metrics.LevenshteinDistanceCalculator.html#scirpy.ir_dist.metrics.LevenshteinDistanceCalculator" title="scirpy.ir_dist.metrics.LevenshteinDistanceCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">LevenshteinDistanceCalculator</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hamming</span></code> – Hamming distance for CDR3 sequences of equal length.
See <a class="reference internal" href="scirpy.ir_dist.metrics.HammingDistanceCalculator.html#scirpy.ir_dist.metrics.HammingDistanceCalculator" title="scirpy.ir_dist.metrics.HammingDistanceCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">HammingDistanceCalculator</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alignment</span></code> – Distance based on pairwise sequence alignments using the
BLOSUM62 matrix. This option is incompatible with nucleotide sequences.
See <a class="reference internal" href="scirpy.ir_dist.metrics.AlignmentDistanceCalculator.html#scirpy.ir_dist.metrics.AlignmentDistanceCalculator" title="scirpy.ir_dist.metrics.AlignmentDistanceCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlignmentDistanceCalculator</span></code></a>.</p></li>
<li><p>any instance of <a class="reference internal" href="scirpy.ir_dist.metrics.DistanceCalculator.html#scirpy.ir_dist.metrics.DistanceCalculator" title="scirpy.ir_dist.metrics.DistanceCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistanceCalculator</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt><strong>cutoff</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</dt><dd><p>All distances <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">cutoff</span></code> will be replaced by <code class="docutils literal notranslate"><span class="pre">0</span></code> and eliminated from the sparse
matrix. A sensible cutoff depends on the distance metric, you can find
information in the corresponding docs. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, the cutoff
will be <code class="docutils literal notranslate"><span class="pre">10</span></code> for the <code class="docutils literal notranslate"><span class="pre">alignment</span></code> metric, and <code class="docutils literal notranslate"><span class="pre">2</span></code> for <code class="docutils literal notranslate"><span class="pre">levenshtein</span></code> and <code class="docutils literal notranslate"><span class="pre">hamming</span></code>.
For the identity metric, the cutoff is ignored and always set to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</dd>
<dt><strong>n_jobs</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</dt><dd><p><p>Number of CPU cores to use when running a DistanceCalculator that supports
paralellization.</p>
<p>A cutoff of 0 implies the <code class="docutils literal notranslate"><span class="pre">identity</span></code> metric.</p>
</p>
</dd>
<dt><strong>kwargs</strong></dt><dd><p>Additional parameters passed to the <a class="reference internal" href="scirpy.ir_dist.metrics.DistanceCalculator.html#scirpy.ir_dist.metrics.DistanceCalculator" title="scirpy.ir_dist.metrics.DistanceCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistanceCalculator</span></code></a>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><span class="annotation terse"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.7.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">csr_matrix</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.7.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">csr_matrix</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Symmetrical, sparse pairwise distance matrix.</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="scirpy.util.graph.igraph_from_sparse_matrix.html" class="btn btn-neutral float-left" title="scirpy.util.graph.igraph_from_sparse_matrix" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="scirpy.ir_dist.metrics.DistanceCalculator.html" class="btn btn-neutral float-right" title="scirpy.ir_dist.metrics.DistanceCalculator" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Gregor Sturm, Tamas Szabo..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>