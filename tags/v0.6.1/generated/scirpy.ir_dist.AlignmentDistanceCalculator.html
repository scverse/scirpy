

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>scirpy.ir_dist.AlignmentDistanceCalculator &mdash; scirpy  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/scanpy.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/typehints.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="scirpy.ir_dist.AlignmentDistanceCalculator.DTYPE" href="scirpy.ir_dist.AlignmentDistanceCalculator.DTYPE.html" />
    <link rel="prev" title="scirpy.ir_dist.HammingDistanceCalculator.calc_dist_mat" href="scirpy.ir_dist.HammingDistanceCalculator.calc_dist_mat.html" />
 


</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/scirpy_logo_bright.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.6.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage-principles.html">Usage principles</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api.html#input-output-io">Input/Output: <code class="docutils literal notranslate"><span class="pre">io</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.pp">Preprocessing: <code class="docutils literal notranslate"><span class="pre">pp</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#tools-tl">Tools: <code class="docutils literal notranslate"><span class="pre">tl</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.pl">Plotting: <code class="docutils literal notranslate"><span class="pre">pl</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.datasets">Datasets: <code class="docutils literal notranslate"><span class="pre">datasets</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-scirpy.util">Utility functions: <code class="docutils literal notranslate"><span class="pre">util</span></code></a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#module-scirpy.ir_dist">IR distance metrics: <code class="docutils literal notranslate"><span class="pre">ir_dist</span></code></a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="scirpy.ir_dist.sequence_dist.html">scirpy.ir_dist.sequence_dist</a></li>
<li class="toctree-l3"><a class="reference internal" href="scirpy.ir_dist.DistanceCalculator.html">scirpy.ir_dist.DistanceCalculator</a></li>
<li class="toctree-l3"><a class="reference internal" href="scirpy.ir_dist.ParallelDistanceCalculator.html">scirpy.ir_dist.ParallelDistanceCalculator</a></li>
<li class="toctree-l3"><a class="reference internal" href="scirpy.ir_dist.IdentityDistanceCalculator.html">scirpy.ir_dist.IdentityDistanceCalculator</a></li>
<li class="toctree-l3"><a class="reference internal" href="scirpy.ir_dist.LevenshteinDistanceCalculator.html">scirpy.ir_dist.LevenshteinDistanceCalculator</a></li>
<li class="toctree-l3"><a class="reference internal" href="scirpy.ir_dist.HammingDistanceCalculator.html">scirpy.ir_dist.HammingDistanceCalculator</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">scirpy.ir_dist.AlignmentDistanceCalculator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="scirpy.ir_dist.AlignmentDistanceCalculator.DTYPE.html">scirpy.ir_dist.AlignmentDistanceCalculator.DTYPE</a></li>
<li class="toctree-l4"><a class="reference internal" href="scirpy.ir_dist.AlignmentDistanceCalculator.calc_dist_mat.html">scirpy.ir_dist.AlignmentDistanceCalculator.calc_dist_mat</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ir-biology.html">Immune receptor (IR) model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zzz_bibliography.html">Bibliography</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">scirpy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../api.html">API</a> &raquo;</li>
        
      <li>scirpy.ir_dist.AlignmentDistanceCalculator</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <!-- User defined GitHub URL -->
              <a href="https://github.com/icbi-lab/scirpy/tree/master/scirpy/ir_dist/__init__.py#L400-L505" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="scirpy-ir-dist-alignmentdistancecalculator">
<h1>scirpy.ir_dist.AlignmentDistanceCalculator<a class="headerlink" href="#scirpy-ir-dist-alignmentdistancecalculator" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="scirpy.ir_dist.AlignmentDistanceCalculator">
<em class="property">class </em><code class="sig-prename descclassname">scirpy.ir_dist.</code><code class="sig-name descname">AlignmentDistanceCalculator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cutoff</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">n_jobs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">block_size</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">subst_mat</span><span class="o">=</span><span class="default_value">'blosum62'</span></em>, <em class="sig-param"><span class="n">gap_open</span><span class="o">=</span><span class="default_value">11</span></em>, <em class="sig-param"><span class="n">gap_extend</span><span class="o">=</span><span class="default_value">11</span></em><span class="sig-paren">)</span><a class="headerlink" href="#scirpy.ir_dist.AlignmentDistanceCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates distance between sequences based on pairwise sequence alignment.</p>
<p>The distance between two sequences is defined as <span class="math notranslate nohighlight">\(S_{1,2}^{max} - S_{1,2}\)</span>,
where <span class="math notranslate nohighlight">\(S_{1,2}\)</span> is the alignment score of sequences 1 and 2 and
<span class="math notranslate nohighlight">\(S_{1,2}^{max}\)</span> is the max. achievable alignment score of sequences 1 and 2.
<span class="math notranslate nohighlight">\(S_{1,2}^{max}\)</span> is defined as <span class="math notranslate nohighlight">\(\min(S_{1,1}, S_{2,2})\)</span>.</p>
<p>The use of alignment-based distances is heavily inspired by <span id="id1">[<a class="reference internal" href="../zzz_bibliography.html#id6"><span>DFGH+17</span></a>]</span>.</p>
<p>High-performance sequence alignments are calculated leveraging
the <a class="reference external" href="https://github.com/jeffdaily/parasail-python">parasail library</a> (<span id="id2">[<a class="reference internal" href="../zzz_bibliography.html#id17"><span>Dai16</span></a>]</span>).</p>
<dl>
<dt>Choosing a cutoff:</dt><dd><p>Alignment distances need to be viewed in the light of the substitution matrix.
The alignment distance is the difference between the actual alignment
score and the max. achievable alignment score. For instance, a mutation
from <em>Leucine</em> (<code class="docutils literal notranslate"><span class="pre">L</span></code>) to <em>Isoleucine</em> (<code class="docutils literal notranslate"><span class="pre">I</span></code>) results in a BLOSUM62 score of <code class="docutils literal notranslate"><span class="pre">2</span></code>.
An <code class="docutils literal notranslate"><span class="pre">L</span></code> aligned with <code class="docutils literal notranslate"><span class="pre">L</span></code> achieves a score of <code class="docutils literal notranslate"><span class="pre">4</span></code>. The distance is, therefore, <code class="docutils literal notranslate"><span class="pre">2</span></code>.</p>
<p>On the other hand, a single <em>Tryptophane</em> (<code class="docutils literal notranslate"><span class="pre">W</span></code>) mutating into, e.g.
<em>Proline</em> (<code class="docutils literal notranslate"><span class="pre">P</span></code>) already results in a distance of <code class="docutils literal notranslate"><span class="pre">15</span></code>.</p>
<p>We are still lacking empirical data up to which distance a CDR3 sequence still
is likely to recognize the same antigen, but reasonable cutoffs are <code class="docutils literal notranslate"><span class="pre">&lt;15</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cutoff</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</dt><dd><p>Will eleminate distances &gt; cutoff to make efficient
use of sparse matrices. The default cutoff is <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p>
</dd>
<dt><strong>n_jobs</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</dt><dd><p>Number of jobs to use for the pairwise distance calculation.
If None, use all jobs (only for ParallelDistanceCalculators).</p>
</dd>
<dt><strong>block_size</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">50</span></code>)</dt><dd><p>The width of a block of the matrix that will be delegated to a worker
process. The block contains <code class="docutils literal notranslate"><span class="pre">block_size</span> <span class="pre">**</span> <span class="pre">2</span></code> elements.</p>
</dd>
<dt><strong>subst_mat</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">'blosum62'</span></code>)</dt><dd><p>Name of parasail substitution matrix</p>
</dd>
<dt><strong>gap_open</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">11</span></code>)</dt><dd><p>Gap open penalty</p>
</dd>
<dt><strong>gap_extend</strong> : <span class="annotation terse"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span><span class="annotation full"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">11</span></code>)</dt><dd><p>Gap extend penatly</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Attributes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="scirpy.ir_dist.AlignmentDistanceCalculator.DTYPE.html#scirpy.ir_dist.AlignmentDistanceCalculator.DTYPE" title="scirpy.ir_dist.AlignmentDistanceCalculator.DTYPE"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DTYPE</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="scirpy.ir_dist.AlignmentDistanceCalculator.calc_dist_mat.html#scirpy.ir_dist.AlignmentDistanceCalculator.calc_dist_mat" title="scirpy.ir_dist.AlignmentDistanceCalculator.calc_dist_mat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_dist_mat</span></code></a>(seqs[, seqs2])</p></td>
<td><p>Calculate the distance matrix.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="scirpy.ir_dist.AlignmentDistanceCalculator.DTYPE.html" class="btn btn-neutral float-right" title="scirpy.ir_dist.AlignmentDistanceCalculator.DTYPE" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="scirpy.ir_dist.HammingDistanceCalculator.calc_dist_mat.html" class="btn btn-neutral float-left" title="scirpy.ir_dist.HammingDistanceCalculator.calc_dist_mat" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Gregor Sturm, Tamas Szabo.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>